function gashaponAnimation(e){const t=document.documentElement.style;"play"===e?(t.setProperty("--play-number","1"),t.setProperty("--play-state","running"),itemId.forEach(e=>{document.querySelector(e).style.animationName=""})):"stop"===e?(t.setProperty("--play-number","0"),t.setProperty("--play-state","paused"),itemId.forEach(e=>{document.querySelector(e).style.animationName="unset"})):"drop"===e&&(getRandomGashapon(),t.setProperty("--play-number-drop","1"),t.setProperty("--play-state-drop","running"),dropGashaponId.forEach(e=>{document.querySelector(e).style.animationName=""}),setTimeout(()=>{t.setProperty("--play-number-drop","0"),t.setProperty("--play-state-drop","paused"),dropGashaponId.forEach(e=>{document.querySelector(e).style.animationName="unset"})},3e3))}function gashaponScale(e){const t=document.querySelector(".gashapon-main"),o=document.querySelector(".energy-bar");"reset"===e&&(t.style.transition="",t.style.transform=""),"rebound-short"===e&&(t.style.transition="1s",t.style.transform="scale(1.05, 0.95)",setTimeout(()=>{t.style.transform="",o.style.transition="",t.classList.add("default-animation")},1e3)),"rebound-high"===e&&(t.style.transition="1s",t.style.transform="scale(0.95, 1.05)",setTimeout(()=>{t.style.transform="",o.style.transition="",t.classList.add("default-animation")},1e3)),"reduction"===e&&(t.style.transition="1s",t.style.transform="",t.classList.add("default-animation"))}function getRandomGashapon(){const e=getRandom(dropGashaponColor.length)-1;document.querySelector("#drop-gashapon").style.fill=dropGashaponColor[e],document.querySelector("#drop-gashapon-m").style.fill=dropGashaponColor[e],document.querySelector(".modal-header").style.background=modalBackground[e]}function getTriggerHeight(){windowsHeight=document.body.clientHeight,triggerHeight=windowsHeight/4,console.log(triggerHeight)}function showCoordinates(e){var t=e.touches[0].clientX,o=e.touches[0].clientY;document.getElementById("mobiletouch").innerHTML=t+", "+o}function mouseDown(e){null==e.touches&&(document.querySelector(".curzr .outer").style.fill="#f6c0bb"),0==modalState&&(getTriggerHeight(),document.querySelector(".energy-bar").style.transition="0s",gashaponScale("reset"),gashaponAnimation("stop"),mouseClick_Y=e.pageY,void 0===e.pageY&&(mouseClick_Y=e.touches[0].clientY),mouseState=1)}function mouseMove(e){if(1==mouseState&&0==modalState){const t=document.querySelector(".gashapon-main");t.classList.remove("default-animation");let o=e.pageY;void 0===o&&(o=e.touches[0].clientY),mouseMove_Y=mouseClick_Y-o,gashaponScale_X=-(5e-4*mouseMove_Y-1),gashaponScale_Y=.001*mouseMove_Y+1;const r=`scale(${gashaponScale_X},${gashaponScale_Y})`;t.style.transform=r,(mouseMove_Y<-30||mouseMove_Y>30)&&closeMenu();const n=document.querySelector(".energy-bar"),a=document.querySelector(".hint-text .energy"),s=document.querySelector(".hint-text .text");mouseMove_Y<0?(n.style.transform=`scaleY(${mouseMove_Y/(-1*triggerHeight)})`,a.style.transform=`scaleX(${mouseMove_Y/(-1*triggerHeight)})`,mouseMove_Y<-triggerHeight&&(s.textContent="可放開扭蛋機")):mouseMove_Y>0?(n.style.transform=`scaleY(${mouseMove_Y/triggerHeight})`,a.style.transform=`scaleX(${mouseMove_Y/triggerHeight})`,mouseMove_Y>triggerHeight&&(s.textContent="可放開扭蛋機")):s.textContent="請持續滑動"}}function mouseUp(e){null==e.touches&&(document.querySelector(".curzr .outer").style.fill=""),document.querySelector(".energy-bar").style.transition="1s",document.querySelector(".energy-bar").style.transform="scaleY(0)",document.querySelector(".hint-text .energy").style.transition="0.2s",document.querySelector(".hint-text .energy").style.transform="scaleX(0)",1==mouseState&&(mouseMove_Y<=0&&mouseMove_Y<-100?(gashaponScale("rebound-high"),document.querySelector(".hint-text .text").textContent="按住螢幕滑動"):mouseMove_Y>0&&mouseMove_Y>100?(gashaponScale("rebound-short"),document.querySelector(".hint-text .text").textContent="按住螢幕滑動"):(gashaponScale("reduction"),document.querySelector(".hint-text .text").textContent="按住螢幕滑動"),(mouseMove_Y<-1*triggerHeight||mouseMove_Y>triggerHeight)&&(modalState=1,gashaponAnimation("play"),setTimeout(function(){gashaponAnimation("drop")},1250),document.querySelector(".hint-text .text").textContent="顯示結果",showResultModal())),mouseState=0,mouseMove_Y=0}function showResultModal(){setTimeout(function(){if(void 0===dataObjectArray||0===importState){let e=new bootstrap.Modal(document.getElementById("import-modal"));e.show();const t=document.getElementById("import-modal-cancel");t&&t.addEventListener("click",function(){modalState=0;const e=document.querySelector(".hint-text .text");0===importState?e.textContent="資料尚未匯入":e.textContent="按住螢幕滑動"})}else{printResultText();let e=new bootstrap.Modal(document.getElementById("result-modal"));e.show()}},3e3)}function printResultText(){const e=document.querySelector(".modal-body .result-content");let t;if(e.innerHTML="",document.querySelector(".modal-body-result .modal-no-data").style.display="none",1===repeatDrawState)console.log("重複抽獎"),t=getRandom(dataObjectArray.length)-1;else if(0===repeatDrawState){console.log("不重複抽獎");const e=dataObjectArray.every(e=>e.itemIsDrawn);if(e)return console.log("全部都抽完"),void(document.querySelector(".modal-body-result .modal-no-data").style.display="block");do{t=getRandom(dataObjectArray.length)-1}while(dataObjectArray[t].itemIsDrawn)}console.log(dataObjectArray,t),dataObjectArray[t].itemCount++,0===repeatDrawState&&(dataObjectArray[t].itemIsDrawn=!0),printGachaList(),historyList.push(dataObjectArray[t][csvList[0][0]]),printHistoryList(),document.querySelectorAll(".gacha-list .item").forEach(e=>e.classList.remove("active")),document.getElementById(dataObjectArray[t].itemId).classList.add("active");const o=csvList[0],r=o.length;o.forEach(o=>{const n=dataObjectArray[t][o];r>1||"地址"===o||"圖片"===o?"地址"===o?e.innerHTML+=`<p>${o}：<a href='https://www.google.com/maps/place/${n}' target='_blank'>${n}</a></p>`:"圖片"===o?e.innerHTML+=`<img src='${n}' class='result-img'>`:isURL(n)?isImageURL(n)?e.innerHTML+=`<p>${o}</p><img src='${n}' class='result-img'>`:e.innerHTML+=`<p>${o}：<a href='${n}' target='_blank'>${n}</a></p>`:e.innerHTML+=`<p>${o}：${n}</p>`:e.innerHTML+=`<p class='text-lg text-center'>${n}</p>`})}function showModal(e){closeModal();const t=new bootstrap.Modal(e);t.show(),closeMenu(),modalState=1}function closeModal(){let e=document.querySelectorAll(".modal");e.forEach(e=>{let t=bootstrap.Modal.getInstance(e);t&&t.hide()});const t=document.querySelector(".hint-text .text");t&&(t.textContent="按住螢幕滑動"),modalState=0}function isURL(e){const t=/^(ftp|http|https):\/\/[^ "]+$/;return t.test(e)}function isImageURL(e){const t=/\.(jpeg|jpg|gif|png|webp)$/i;return t.test(e)}function getRandom(e){return Math.floor(Math.random()*e)+1}const rangeWrapper=document.querySelector("body");let mouseClick_Y=0,mouseMove_Y=0,mouseState=0,modalState=0,gashaponScale_X=0,gashaponScale_Y=0,windowsHeight=document.body.clientHeight,triggerHeight=windowsHeight/4,itemId=["#e0dj51prVt431_to","#e0dj51prVt432_to","#e0dj51prVt433_to","#e0dj51prVt434_to","#e0dj51prVt435_to","#e0dj51prVt438_tr","#e0dj51prVt439_tr","#e0dj51prVt440_tr","#e0dj51prVt441_tr","#e0dj51prVt442_tr","#e0dj51prVt443_tr","#e0dj51prVt444_tr","#e0dj51prVt445_tr","#e0dj51prVt446_tr","#e0dj51prVt447_tr","#e0dj51prVt448_tr","#e0dj51prVt449_tr","#e0dj51prVt450_tr","#e0dj51prVt451_tr","#e0dj51prVt452_tr","#e0dj51prVt455_to","#e0dj51prVt455_tr","#e0dj51prVt458_to","#e0dj51prVt458_tr","#e0dj51prVt461_to","#e0dj51prVt461_tr","#e0dj51prVt464_to","#e0dj51prVt464_tr","#e0dj51prVt467_to","#e0dj51prVt467_tr","#e0dj51prVt470_to","#e0dj51prVt470_tr","#e0dj51prVt473_to","#e0dj51prVt473_tr","#e0dj51prVt476_to","#e0dj51prVt476_tr","#e0dj51prVt479_to","#e0dj51prVt479_tr","#e0dj51prVt482_to","#e0dj51prVt482_tr","#e0dj51prVt485_to","#e0dj51prVt485_tr","#e0dj51prVt488_to","#e0dj51prVt488_tr"],dropGashaponId=["#e0dj51prVt428_to","#e0dj51prVt428_tr","#e0dj51prVt428_ts","#e0dj51prVt428","#XXX_to","#XXX_tr","#XXX_ts","#XXX"],dropGashaponColor=["#ff8271","#ca8ff7","#ffd278","#b7dd87","#9db1ef"],modalBackground=["#f7524b","#a159d9","#f5ad56","#accf4e","#6685e3"];rangeWrapper.addEventListener("mousedown",mouseDown),rangeWrapper.addEventListener("touchstart",mouseDown),rangeWrapper.addEventListener("mousemove",mouseMove),rangeWrapper.addEventListener("touchmove",mouseMove),rangeWrapper.addEventListener("mouseup",mouseUp),rangeWrapper.addEventListener("mouseleave",mouseUp),rangeWrapper.addEventListener("touchend",mouseUp);